data<-data(iris)
head(data)
sourse(iris)
data<-iris
data
x<-aggregate(data[,-5],average,by=lib(data[,5])
)
x<-aggregate(data[,-5],Fun=mean,by=list(data[,5]))
x<-aggregate(data[,-5],FUm=mean,by=list(data[,5]))
x<-aggregate(data[,-5],FUN=mean,by=list(data[,5]))
x
x<-aggregate(data[,-5],FUN=mean,by=list(data[,5]))
x
x<-seq(1:40)
x
plot(x,dnorm(x,20,5),type="l")
par(new=T)
hist(rnorm(100000,20,5))
data<-iris
x<-aggregate(data[,5],mean,by=list(data[,-5]))
x<-aggregate(data[,5], mean, by=list(data[,-5]))
x<-aggregate(data[,-5], mean, by=list(data[,5]))
x
x<-aggregate(data[,-5], sum, by=list(data[,5]))
x
x<-aggregate(data[,-5], sn, by=list(data[,5]))
x<-aggregate(data[,-5], sm, by=list(data[,5]))
utils:::menuInstallPkgs()
library("RFinanceYJ")
stock <- quoteStockTsData(’4689.t’, since=’2012-01-04’,time.interval=’daily’)
setwd("D:/RW")
library(mvpart)
data<-read.csv("CodeIQ_Finance_rev2.csv")
#data<-read.table("tesehoge.txt",head=T)
modData <- data[,-11]
head(modData)
rep<-rpart(プリペイ2~.,data=modData,cp=0.002)
plot(rep,uniform=TRUE)
text(rep,use.n=T,all=T)
data<-read.csv("CodeIQ_Finance.csv")
#data<-read.table("tesehoge.txt",head=T)
modData <- data[,-11]
rep<-rpart(プリペイ2~.,data=modData,cp=0.002,type="class")
help(rpart)
data<-read.csv("CodeIQ_Finance.csv")
#data<-read.table("tesehoge.txt",head=T)
modData <- data[,-11]
rep<-rpart(プリペイ2~.,data=modData,cp=0.002,method="class")
plot(rep,uniform=TRUE)
text(rep,use.n=T,all=T)
nrow(modData)
nrow(modData[,11])
nrow(modData[,10])
nrow(modData[,9])
nrow(modData[,1])
nrow(modData)
x <- modData[,10]
nrow(x)
nrow(as.data.frame(x)
)
nrow(as.data.frame(modData[,1])
)
nrow(as.data.frame(modData[,2]))
nrow(as.data.frame(modData[,3]))
nrow(as.data.frame(modData[,4]))
nrow(as.data.frame(modData[,]))
nrow(as.data.frame(modData[,5]))
nrow(as.data.frame(modData[,6]))
nrow(as.data.frame(modData[,7]))
nrow(as.data.frame(modData[,8]))
nrow(as.data.frame(modData[,9]))
nrow(as.data.frame(modData[,10]))
nrow(as.data.frame(modData[,11]))
nrow(as.data.frame(modData[,12]))
ncol(as.data.frame(modData[1,]))
ncol(as.data.frame(modData[2,]))
ncol(as.data.frame(modData[8993,]))
ncol(as.data.frame(modData[8994,]))
ncol(as.data.frame(modData[8995,]))
ncol(as.data.frame(modData[8996,]))
data<-read.csv("CodeIQ_Finance.csv")
#data<-read.table("tesehoge.txt",head=T)
modData <- data[,-11]
rep<-rpart(プリペイ2~.,data=modData,cp=0.002,method="class")
plot(rep,uniform=TRUE)
text(rep,use.n=T,all=T)
modData
data<-read.csv("CodeIQ_Finance.csv")
#data<-read.table("tesehoge.txt",head=T)
modData <- data[,-12]
rep<-rpart(プリペイ2~.,data=modData,cp=0.002,method="class")
plot(rep,uniform=TRUE)
text(rep,use.n=T,all=T)
head(modData)
data<-read.csv("CodeIQ_Finance.csv")
#data<-read.table("tesehoge.txt",head=T)
modData <- data[,-12]
rep<-rpart(プリペイ2_年~.,data=modData,cp=0.002,method="class")
plot(rep,uniform=TRUE)
text(rep,use.n=T,all=T)
#data<-read.csv("CodeIQ_Finance.csv")
data<-read.table("tesehoge.txt",head=T)
modData <- data[,-12]
rep<-rpart(プリペイ2~.,data=modData,cp=0.002,method="class")
#data<-read.csv("CodeIQ_Finance.csv")
data<-read.table("tesehoge.txt",head=T)
modData <- data[,-11]
rep<-rpart(プリペイ2~.,data=modData,cp=0.002,method="class")
plot(rep,uniform=TRUE)
text(rep,use.n=T,all=T)
rep<-rpart(data[,11]~.,data=modData,cp=0.002,method="class")
plot(rep,uniform=TRUE)
text(rep,use.n=T,all=T)
head(modData)
#data<-read.csv("CodeIQ_Finance.csv")
data<-read.table("tesehoge.txt",head=T)
modData <- data[,-11]
rep<-rpart(modData[,11]~.,data=modData,cp=0.002,method="class")
plot(rep,uniform=TRUE)
text(rep,use.n=T,all=T)
#data<-read.csv("CodeIQ_Finance.csv")
data<-read.table("tesehoge.txt",head=T)
modData <- data[,-11]
rep<-rpart(modData[,11]~modData[,-11],data=modData,cp=0.002,method="class")
rep<-rpart(modData[,11]~modData,data=modData,cp=0.002,method="class")
rep<-rpart(modData[,11]~.,data=modData,cp=0.002,method="class")
plot(rep,uniform=TRUE)
text(rep,use.n=T,all=T)
data<-read.table("tesehoge.txt",head=T)
modData <- data[,-11]
rep<-rpart(modData[,11]~.,data=modData,cp=0.002,method="class")
plot(rep,uniform=TRUE)
text(rep,use.n=T,all=T)
setwd("D:/RW")
library(mvpart)
#data<-read.csv("CodeIQ_Finance.csv")
data<-read.table("tesehoge.txt",head=T)
modData <- data[,-11]
rep<-rpart(modData[,11]~.,data=modData,cp=0.002,method="class")
plot(rep,uniform=TRUE)
text(rep,use.n=T,all=T)
text(rep,use.n=T,all=T)
rep<-rpart(modData[,11]~.,data=modData,cp=0.002)
plot(rep,uniform=TRUE)
text(rep,use.n=T,all=T)
rep<-rpart(modData[,11]~.,data=modData,cp=0.0002)
plot(rep,uniform=TRUE)
text(rep,use.n=T,all=T)
rep<-rpart(modData[,11]~.,data=modData,cp=0)
plot(rep,uniform=TRUE)
text(rep,use.n=T,all=T)
rep<-rpart("プリペイ2"~.,data=modData,cp=0)
plot(rep,uniform=TRUE)
text(rep,use.n=T,all=T)
rep<-rpart("プリペイ2"~.,data=modData,cp=0.02)
plot(rep,uniform=TRUE)
text(rep,use.n=T,all=T)
rep<-rpart(プリペイ2~.,data=modData,cp=0.02)
plot(rep,uniform=TRUE)
text(rep,use.n=T,all=T)
rep<-rpart(プリペイ2~.,data=modData,cp=0.02)
plot(rep,uniform=TRUE)
text(rep,use.n=T,all=T)
library(MASS)
library(MASS)
(Z.lda <- lda(modData[,11]~.,data=modData))
(Z.lda <- lda(プリペイ2~.,data=modData))
row_num(nrow(modData))
row_num <- (nrow(modData))
even.n <- sumple(row_num/2,row_num)
even.n <- sample(seq(row_num),row_num/2)
even.n
sort(even.n)
even.n <- sample(seq(row_num),row_num/3)
even.n <- sample(seq(row_num),row_num/3)
train.data <- nodData[-even.n,]
train.data <- modData[-even.n,]
test.data <- modData[even.n,]
(Z.lda <- lda(プリペイ2~.,data=train.data))
y <- predict(Z.lda,test.data[,-11])
table(test.data[,11],y$class)
(Z.qda <- qda(プリペイ2~.,data=train.data))
y <- predict(Z.qda,test.data[,-11])
table(test.data[,11],y$class)
install.packages("randomForest"); library(randomForest)
install.packages("randomForest")
library(randomForest)
set.seed(20)
BC.rf <- randomForest(プリペイ2~.,data=train.data,na.action="na.omit")
print(BC.rf)
plot(BC.rf)
varImpPlot(BC.rf)
BC.rfp <- predict(BC.rf,test.data[,-11])
(BC.rft <- table(test.data[,11],BC.rfp))
round(1-sum(diag(BC.rft))/sum(BC.rft),3)
data<-read.csv("CodeIQ_Finance.csv")
#data<-read.table("tesehoge.txt",head=T)
modData <- data[,-11]
#rep<-rpart(modData[,11]~.,data=modData,cp=0.002,method="class")
rep<-rpart(プリペイ2~.,data=modData,cp=0.02)
plot(rep,uniform=TRUE)
text(rep,use.n=T,all=T)
data<-read.csv("CodeIQ_Finance.csv")
#data<-read.table("tesehoge.txt",head=T)
modData <- data[,-11]
#rep<-rpart(modData[,11]~.,data=modData,cp=0.002,method="class")
rep<-rpart(プリペイ2~.,data=modData,cp=0.002)
plot(rep,uniform=TRUE)
text(rep,use.n=T,all=T)
data<-read.csv("CodeIQ_Finance.csv")
#data<-read.table("tesehoge.txt",head=T)
modData <- data[,-11]
#rep<-rpart(modData[,11]~.,data=modData,cp=0.002,method="class")
rep<-rpart(プリペイ2~.,data=modData,cp=0.0002)
plot(rep,uniform=TRUE)
text(rep,use.n=T,all=T)
rep<-rpart(プリペイ2~.,data=modData,cp=0.001)
plot(rep,uniform=TRUE)
text(rep,use.n=T,all=T)
rep<-rpart(プリペイ2~.,data=modData,cp=0.002)
plot(rep,uniform=TRUE)
text(rep,use.n=T,all=T)
install.packages("randomForest")
library(randomForest)
set.seed(20)
BC.rf <- randomForest(プリペイ2~.,data=train.data,na.action="na.omit")
print(BC.rf)
plot(BC.rf)
varImpPlot(BC.rf)
BC.rfp <- predict(BC.rf,test.data[,-11])
(BC.rft <- table(test.data[,11],BC.rfp))
round(1-sum(diag(BC.rft))/sum(BC.rft),3)
data<-read.table("tesehoge.txt",head=T)
modData <- data[,-11]
data<-read.csv("CodeIQ_Finance_rev2.csv")
#data<-read.table("tesehoge.txt",head=T)
modData <- data[,-11]
fm5 <- glm(プリペイ2~.,data=modData, family=binomial)
mean(fm5)
predict(fm5,type="response")
mean(fm5)
data<-read.csv("CodeIQ_Finance.csv")
#data<-read.table("tesehoge.txt",head=T)
modData <- data[,-11]
fm5 <- glm(プリペイ2~.,data=modData, family=binomial)
predict(fm5,type="response")
mean(fm5)
fm5$coefficients
write.table(x,"output.csv",sep=",")
x <- predict(fm5,type="response")
write.table(x,"output.csv",sep=",")
fm5 <- glm(プリペイ2~.,data=modData, family=binomial)
f <- step(fm5)
help(step)
fm5 <- glm(プリペイ2~.,data=modData, family=binomial)
f <- step(fm5,k=5)
f <- step(fm5,k=20)
f <- step(fm5,k=2)
f <- step(fm5,k=20)
f <- step(fm5,k=3)
f <- step(fm5,k=4)
f <- step(fm5,k=2)
f <- step(fm5,k=1)
f <- step(fm5)
set.seed(20)
BC.rf <- randomForest(プリペイ2~.,data=train.data,na.action="na.omit")
print(BC.rf)
plot(BC.rf)
varImpPlot(BC.rf)
BC.rfp <- predict(BC.rf,test.data[,-11])
